<div class="row a4-page  mt-3">
    <div class="col-md-6">
        <div class="content-header-style-cust mb-3 mt-3" style="background-color: _themeBgColor_; color: _themeTextColor_;">
            <h2 class="content-text-style" style="padding-top: 10px;padding-left: 10px;">_singleMcName_</h2>
        </div>
    </div>
</div>

<div class="row a4-page mt-3 d-flex justify-content-center gap-5 flex-wrap">

    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Open Rate</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsOpenRate_ %</h1>
            </div>
        </div>
    </div>

    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Click Rate</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsClickRate_ %</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Unsubscribe Rate</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsUnsubscribeRate_ %</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Bounce Rate</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsBounceRate_ %</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Clicks</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsClicks_</h1>
            </div>
        </div>
    </div>

    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Subscriber Clicks</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsSubscriberClicks_</h1>
            </div>
        </div>
    </div>

    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Unsubscribes</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsUnsubscribes_</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Opens</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsOpens_</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Orders</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsOrders_</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Average Order</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsAverageOrder_</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Total Revenue</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsTotalRevenue_</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Total Spent</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsTotalSpent_</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Deliveries</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsDeliveries_</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Delivery Rate</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsDeliveryRate_ %</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Spams</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsSpams_</h1>
            </div>
        </div>
    </div>


    <div class="width-18">
        <div class="card">
            <div class="card-bg-1 card-body text-center card-border-radius">
                <h5 class="card-title card-title-color">Spam Rate</h5>
                <h1 class="card-text card-title-color fontxxlrge">_mcsSpamRate_ %</h1>
            </div>
        </div>
    </div>






</div>

<!--Open chart-->

<div class="row a4-page mt-3">
    <div class="col-md-12">
        <div class="card card-body" style="max-height:400px">
            <h4 class="card-title pt-2" style="display: flex; justify-content: space-between;">
                <span style="font-weight:bold;">Opens (24-Hour Period)</span>
                <span style="font-weight:500;">_mcsOpenTotal_</span>
            </h4>
            <div style="display: flex; justify-content: center;">
                <canvas id="_mcsOpenChart_"
                        style="display: block; box-sizing: border-box; height: 300px;width:100%;"></canvas>
            </div>
        </div>
    </div>
</div>


<!--Click chart-->

<div class="row a4-page mt-3">
    <div class="col-md-12">
        <div class="card card-body" style="max-height:400px">
            <h4 class="card-title pt-2" style="display: flex; justify-content: space-between;">
                <span style="font-weight:bold;">Clicks (24-Hour Period)</span>
                <span style="font-weight:500;">_mcsClicksTotal_</span>
            </h4>
            <div style="display: flex; justify-content: center;">
                <canvas id="_mcsClickChart_"
                        style="display: block; box-sizing: border-box; height: 300px;width:100%;"></canvas>
            </div>
        </div>
    </div>
</div>

<!--Activites chart-->

<div class="row a4-page mt-3">
    <div class="col-md-12">
        <div class="card card-body" style="max-height:400px">

            <h4 class="card-title pt-2" style="display: flex; justify-content: space-between;">
                <span style="font-weight:bold;">Activites</span>
            </h4>

            <div class="px-5" style="display: flex; justify-content:center;">
                <div class="mx-5" style="width:410px;">
                    <canvas id="_mcsPieChart_"
                            style="display: block; box-sizing: border-box; height: 300px;"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Top locations-->

<div class="row a4-page mt-3">
    <div class="col-md-12">
        <div class="card card-body" style="max-height:400px">
            <h4 class="card-title pt-2" style="display: flex; justify-content: space-between;">
                <span style="font-weight:bold;">Top Locations</span>
                <span style="font-weight:500;">_mcsLocationTotal_</span>

            </h4>
            <div style="display: flex; justify-content: center;">
                <canvas id="_mcsLocationChart_"
                        style="display: block; box-sizing: border-box; height: 300px;width:100%;"></canvas>
            </div>
        </div>
    </div>
</div>

<!--Progess bar-->
<div class="row a4-page mt-3">
    <div class="col-md-12">
        <div class="card card-body">
            <h4 class="card-title pt-2" style="display: flex;justify-content: space-between;">
                <span style="font-weight:bold;">Top Sources</span>
            </h4>
            <div class="col-md-12" id="_progressBarsContainerForMcId_">
                <!-- Progress bars will be dynamically added here -->
            </div>
            <script>
                var percentageList = [_mcgPercentageList_];
                var valueList = [_mcgValueList_];
                var sourceList = [_mcgSourceList_];


                // Function to create progress bar elements
                function createProgressBar(source, percentage, value) {
                    var progressBarContainer = document.createElement('div');
                    progressBarContainer.classList.add('col-md-12');

                    var progressBarCard = document.createElement('div');


                    var title = document.createElement('h4');
                    title.classList.add('card-title', 'pt-2');
                    title.style.display = 'flex';
                    title.style.justifyContent = 'space-between';

                    var titleSpan = document.createElement('span');
                    titleSpan.style.fontWeight = 'bold';
                    titleSpan.textContent = source;

                    var percentageSpan = document.createElement('span');
                    percentageSpan.textContent = value;

                    title.appendChild(titleSpan);
                    title.appendChild(percentageSpan);

                    var progressDiv = document.createElement('div');
                    progressDiv.classList.add('progress');

                    var progressBar = document.createElement('div');
                    progressBar.classList.add('progress-bar');
                    progressBar.setAttribute('role', 'progressbar');
                    progressBar.style.width = percentage + '%';
                    progressBar.setAttribute('aria-valuenow', percentage);
                    progressBar.setAttribute('aria-valuemin', '0');
                    progressBar.setAttribute('aria-valuemax', '100');

                    var valueDiv = document.createElement('div');
                    valueDiv.classList.add('d-flex', 'justify-content-between', 'mb-1', 'mt-3');

                    var sourceSpan = document.createElement('span');


                    var valueSpan = document.createElement('span');


                    valueDiv.appendChild(sourceSpan);
                    valueDiv.appendChild(valueSpan);

                    title.appendChild(titleSpan);
                    title.appendChild(percentageSpan);

                    progressDiv.appendChild(progressBar);
                    progressBarCard.appendChild(title);
                    progressBarCard.appendChild(progressDiv);
                    progressBarCard.appendChild(valueDiv);
                    progressBarContainer.appendChild(progressBarCard);

                    return progressBarContainer;
                }

                // Get the progress bars container
                var progressBarsContainerForMc = document.getElementById('_progressBarsContainerForMcId_');

                // Loop through the lists and create progress bars
                for (var i = 0; i < percentageList.length; i++) {
                    var percentage = percentageList[i];
                    var value = valueList[i];
                    var source = sourceList[i];

                    var progressBar = createProgressBar(source, percentage, value);
                    progressBarsContainerForMc.appendChild(progressBar);

                }
            </script>

        </div>
    </div>
</div>

<!--Tables-->
<div class="row a4-page mt-3">
    <div class="col-md-12">
        <div class="card card-body text-center">
            <h4 class="card-title pt-2" style="display: flex; justify-content: space-between;">
                <span style="font-weight:bold;">Single Campaign Performance</span>
            </h4>
            <table class="table table-bordered" id="_mcsCampaignTableId_">
                <thead>
                    <tr class="fontsizesmall font-weight-bold table-cell-height">

                        <td class="table-zone td-col-text-style">EMAIL ADDRESS</td>
                        <td class="table-zone td-col-text-style">STATUS</td>
                        <td class="table-zone td-col-text-style">OPEN COUNT</td>

                    </tr>
                </thead>
                <tbody>
                </tbody>
                <tbody class="p-1">
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js"></script>

<script>

    //Open Chart

    var options = {
        type: 'bar',
        data: {
            labels: [_mcOpenLabels_],
            datasets: [{
                fill: false,
                label: "Current Period",
                data: [_mcOpenData1_],
                backgroundColor: "rgb(108 60 179)",
                borderColor: "rgb(108 60 179)",
                borderWidth: 2,
                pointRadius: 2
            }

            ],

        },

        options: {
            maintainAspectRatio: false,
            scales: {

                xAxes: [{

                    type: 'time',
                    time: {
                        unit: 'day',
                        displayFormats: {
                            month: 'MMM YYYY',
                        },
                    },
                    ticks: {
                        fontColor: 'rgb(0,0,0)',
                        fontSize: 14,
                        maxRotation: 0,
                        minRotation: 0,
                        autoSkip: false


                    },
                    gridLines: {
                        display: false // Hide y-axis grid lines
                    }
                }],
                yAxes: [{

                    ticks: {
                        fontColor: 'rgb(0,0,0)',
                        fontSize: 14
                    },
                    gridLines: {
                        display: true // Hide y-axis grid lines
                    }
                }]
            },
            legend: {
                display: false
            },
            responsive: true,
            plugins: {
                legend: {
                    position: "top",
                },
            },

        }
    }
    var ctx = document.getElementById('_mcsOpenChart_').getContext('2d');
    new Chart(ctx, options);

    ////Click Chart

    var options3 = {
        type: 'bar',
        data: {
            labels: [_mcsClickLabels_],
            datasets: [{
                fill: false,
                label: "Current Period",
                data: [_mcsClickData1_],
                backgroundColor: "rgb(108 60 179)",
                borderColor: "rgb(108 60 179)",
                borderWidth: 2,
                pointRadius: 2
            }

            ],

        },

        options: {
            maintainAspectRatio: false,
            scales: {

                xAxes: [{

                    type: 'time',
                    time: {
                        unit: 'day',
                        displayFormats: {
                            month: 'MMM YYYY',
                        },
                    },
                    ticks: {
                        fontColor: 'rgb(0,0,0)',
                        fontSize: 14,
                        maxRotation: 0,
                        minRotation: 0,
                        autoSkip: false


                    },
                    gridLines: {
                        display: false // Hide y-axis grid lines
                    }
                }],
                yAxes: [{

                    ticks: {
                        fontColor: 'rgb(0,0,0)',
                        fontSize: 14
                    },
                    gridLines: {
                        display: true // Hide y-axis grid lines
                    }
                }]
            },
            legend: {
                display: false
            },
            responsive: true,
            plugins: {
                legend: {
                    position: "top",
                },
            },

        }
    }
    var ctx = document.getElementById('_mcsClickChart_').getContext('2d');
    new Chart(ctx, options3);



    ////Activites chart
    var options1 = {
        type: 'doughnut',
        data: {
            labels: [_mcsPieChartLabel_],
            datasets: [{
                label: 'My First Dataset',
                data: [_mcsPieChartData_],
                backgroundColor: ['rgb(108, 60, 179)', 'rgb(217, 198, 247)', 'rgb(232, 167, 211)'],
                hoverOffset: 4
            }]

        },
        options: {
            responsive: true,
            maintainAspectRatio: false,

            legend: {
                labels: {
                    fontColor: 'rgb(0,0,0)',
                    usePointStyle: true,
                    fontSize: 14
                },
                position: "right",
            },
        }
    }
    var ctx = document.getElementById('_mcsPieChart_').getContext('2d');
    new Chart(ctx, options1);


    //Top location chart
    var options2 = {
        type: 'bar',
        data: {
            labels: [_mcsLocationLabels_],
            datasets: [{
                fill: false,
                label: "Current Period",
                data: [_mcsLocationData1_],
                backgroundColor: "rgb(108 60 179)",
                borderColor: "rgb(108 60 179)",
                borderWidth: 2,
                pointRadius: 2
            }

            ],

        },

        options: {
            maintainAspectRatio: false,
            scales: {

                xAxes: [{

                    ticks: {
                        fontColor: 'rgb(0,0,0)',
                        fontSize: 14,
                        maxRotation: 0,
                        minRotation: 0,
                        autoSkip: false


                    },
                    gridLines: {
                        display: false // Hide y-axis grid lines
                    }
                }],
                yAxes: [{

                    ticks: {
                        fontColor: 'rgb(0,0,0)',
                        fontSize: 14
                    },
                    gridLines: {
                        display: true // Hide y-axis grid lines
                    }
                }]
            },
            legend: {
                display: false
            },
            responsive: true,
            plugins: {
                legend: {
                    position: "top",
                },
            },

        }
    }
    var ctx = document.getElementById('_mcsLocationChart_').getContext('2d');
    new Chart(ctx, options2);

    //Top Link Clicks




    ////TABLE DATA
    var mcTableArray = _mcsCampaignTable_;

    var wctable1 = document.getElementById("_mcsCampaignTableId_").getElementsByTagName('tbody')[0];
    for (var i = 0; i < mcTableArray.length; i++) {
        var row = wctable1.insertRow(i);
        row.classList.add('text-align-start');

        var cell1 = row.insertCell(0);
        cell1.innerHTML = mcTableArray[i].Email;

        var cell2 = row.insertCell(1);
        cell2.innerHTML = mcTableArray[i].Status;

        var cell3 = row.insertCell(2);
        cell3.innerHTML = mcTableArray[i].OpenCount;

    }

</script>

