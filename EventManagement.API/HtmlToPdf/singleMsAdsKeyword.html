<div class="row a4-page mt-3">
    <div class="col-md-6">
        <div class="content-header-style-cust mb-3 mt-3" style="background-color: _themeBgColor_; color: _themeTextColor_;">
            <h2 class="content-text-style" style="padding-top: 10px;padding-left: 10px;">_singleMsAdsKeywordName_</h2>
        </div>
    </div>
    <div class="col-md-12">
        <div class="card card-body" style="max-height:400px">
            <h4 class="card-title pt-2" style="display: flex; justify-content: space-between;">
                <span style="font-weight:bold;">_msAdsLineTitle_</span>
                <span style="font-weight:bold;">_msAdsLineTotal_</span>

            </h4>
            <div style="display: flex; justify-content: center;">
                <canvas id="_msAdsLineChartId_"
                        style="display: block; box-sizing: border-box; height: 300px;width:100%;"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="row a4-page mt-3">
    <div class="col-md-12">
        <div class="card card-body">
            <h4 class="card-title pt-2" style="display: flex;justify-content: space-between;">
                <span style="font-weight:bold;">Clicks</span>
            </h4>
            <div class="col-md-12" id="_msAdsBarsContainerId_">
                <!-- Progress bars will be dynamically added here -->
            </div>

            <script>
                // Sample data: source values, percentages, and values

                var percentageList = [_msAdsPercentageList_];
                var valueList = [_msAdsValueList_];
                var sourceList = [_msAdsSourceList_];


                // Function to create progress bar elements
                function createProgressBar(source, percentage, value) {
                    var progressBarContainer = document.createElement('div');
                    progressBarContainer.classList.add('col-md-12');

                    var progressBarCard = document.createElement('div');


                    var title = document.createElement('h4');
                    title.classList.add('card-title', 'pt-2');
                    title.style.display = 'flex';
                    title.style.justifyContent = 'space-between';

                    var titleSpan = document.createElement('span');
                    titleSpan.style.fontWeight = 'bold';
                    titleSpan.textContent = source;

                    var percentageSpan = document.createElement('span');
                    percentageSpan.textContent = value;

                    title.appendChild(titleSpan);
                    title.appendChild(percentageSpan);

                    var progressDiv = document.createElement('div');
                    progressDiv.classList.add('progress');

                    var progressBar = document.createElement('div');
                    progressBar.classList.add('progress-bar');
                    progressBar.setAttribute('role', 'progressbar');
                    progressBar.style.width = percentage + '%';
                    progressBar.setAttribute('aria-valuenow', percentage);
                    progressBar.setAttribute('aria-valuemin', '0');
                    progressBar.setAttribute('aria-valuemax', '100');

                    var valueDiv = document.createElement('div');
                    valueDiv.classList.add('d-flex', 'justify-content-between', 'mb-1', 'mt-3');

                    var sourceSpan = document.createElement('span');


                    var valueSpan = document.createElement('span');


                    valueDiv.appendChild(sourceSpan);
                    valueDiv.appendChild(valueSpan);

                    title.appendChild(titleSpan);
                    title.appendChild(percentageSpan);

                    progressDiv.appendChild(progressBar);
                    progressBarCard.appendChild(title);
                    progressBarCard.appendChild(progressDiv);
                    progressBarCard.appendChild(valueDiv);
                    progressBarContainer.appendChild(progressBarCard);

                    return progressBarContainer;
                }

                // Get the progress bars container
                var progressBarsContainer = document.getElementById('_msAdsBarsContainerId_');

                // Loop through the lists and create progress bars
                for (var i = 0; i < percentageList.length; i++) {
                    var percentage = percentageList[i];
                    var value = valueList[i];
                    var source = sourceList[i];

                    var progressBar = createProgressBar(source, percentage, value);
                    progressBarsContainer.appendChild(progressBar);
                }
            </script>
        </div>
    </div>
</div>

<div class="row a4-page">
    <div class="col-md-6">
        <div class="content-header-style-cust  mt-3" style="background-color: _themeBgColor_; color: _themeTextColor_;">
            <h2 class="content-text-style" style="padding-top: 10px;padding-left: 10px;">Microsoft Ads - Keywords Total Performance</h2>
        </div>
    </div>
    <div class="col-md-12 flex-style p-0 mt-3">

        <div class="col-md-3">
            <div class="card">
                <div class="card-bg-1 card-body text-center card-border-radius">
                    <h5 class="card-title card-title-color">Clicks</h5>
                    <h1 class="card-text card-title-color fontxxlrge">_msAdsClicksData_</h1>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class=" card-bg-1 card-body text-center card-border-radius">
                    <h5 class="card-title card-title-color">Impressions</h5>
                    <h1 class="card-text card-title-color fontxxlrge">_msAdImpressionsData_</h1>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-bg-1 card-body text-center card-border-radius">
                    <h5 class="card-title card-title-color">CTR</h5>
                    <h1 class="card-text card-title-color fontxxlrge">_msAdCTRData_</h1>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-bg-1 card-body text-center card-border-radius">
                    <h5 class="card-title card-title-color">Average CPC</h5>
                    <h1 class="card-text card-title-color fontxxlrge"><span><!--_msAdsCurrencyData_--> </span>_msAdAVGCPCData_</h1>
                </div>
            </div>
        </div>

    </div>
    <div class="col-md-12 flex-style p-0 mt-3">
        <div class="col-md-3">
            <div class="card">
                <div class="card-bg-1 card-body text-center card-border-radius">
                    <h5 class="card-title card-title-color">Cost</h5>
                    <h1 class="card-text card-title-color fontxxlrge"><span><!--_msAdsCurrencyData_--> </span>_msAdCostData_</h1>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-bg-1 card-body text-center card-border-radius">
                    <h5 class="card-title card-title-color">Conversions</h5>
                    <h1 class="card-text card-title-color fontxxlrge">_msAdsConversions_</h1>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-bg-1 card-body text-center card-border-radius">
                    <h5 class="card-title card-title-color">Conversion Rate</h5>
                    <h1 class="card-text card-title-color fontxxlrge">_msAdsCoversionRate_</h1>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class=" card-bg-1 card-body text-center card-border-radius">
                    <h5 class="card-title card-title-color">Cost Per Conversion</h5>
                    <h1 class="card-text card-title-color fontxxlrge"><span><!--_msAdsCurrencyData_--> </span>_msAdsCostPerConversion_</h1>
                </div>
            </div>
        </div>
    </div>

</div>

<div class="row a4-page mt-3">
    <div class="col-md-12">
        <div class="card card-body text-center">
            <h4 class="card-title pt-2" style="display: flex; justify-content: space-between;">
                <span style="font-weight:bold;">Microsoft Keywords Table</span>
            </h4>
            <table class="table table-bordered" id="_msAdsKeywordTableId_">
                <thead>
                    <tr class="fontsizesmall font-weight-bold table-cell-height">
                        <td class="table-zone td-col-text-style">KEYWORD</td>
                        <td class="table-zone td-col-text-style">AD GROUP</td>
                        <td class="table-zone td-col-text-style">CAMPAIGN</td>
                        <td class="table-zone td-col-text-style">STATUS</td>
                        <td class="table-zone td-col-text-style">CLICKS</td>
                        <td class="table-zone td-col-text-style">IMPRES...</td>
                        <td class="table-zone td-col-text-style">CTR</td>
                        <td class="table-zone td-col-text-style">AVG CPC</td>
                        <td class="table-zone td-col-text-style">COST</td>
                        <td class="table-zone td-col-text-style">CONVERS</td>
                        <td class="table-zone td-col-text-style">CONVERS</td>
                        <td class="table-zone td-col-text-style">COST PER</td>
                    </tr>
                </thead>
                <tbody>
                </tbody>
                <tbody class="p-1">
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>

    var labelnterval = _msAdsLabelInterval_;

    var options = {
        type: 'line',
        data: {
            labels: [_msAdsLineChartLabel_],
            datasets: [{
                fill: false,
                label: "Current Period",
                data: [_msLineChartData_],
                backgroundColor: "rgb(108 60 179)",
                borderColor: "rgb(108 60 179)",
                borderWidth: 2,
                pointRadius: 2
            }

            ],

        },

        options: {
            maintainAspectRatio: false,
            scales: {

                xAxes: [{
                    ticks: {
                        fontColor: 'rgb(0,0,0)',
                        fontSize: 14,
                        maxRotation: 0,
                        minRotation: 0,
                        autoSkip: false,
                        callback: function (value, index, values) {

                            return index % labelnterval === 0 ? value : '';
                        }


                    },
                    gridLines: {
                        display: false // Hide y-axis grid lines
                    }
                }],
                yAxes: [{

                    ticks: {
                        fontColor: 'rgb(0,0,0)',
                        fontSize: 14
                    },
                    gridLines: {
                        display: true // Hide y-axis grid lines
                    }
                }]
            },
            legend: {
                display: false
            },
            responsive: true,
            plugins: {
                legend: {
                    position: "top",
                },
            },

        }
    }

    var ctx = document.getElementById('_msAdsLineChartId_').getContext('2d');
    new Chart(ctx, options);  

    var msAdsKeywordTableArray = _msAdsKeywordTableData_;

    var wctable1 = document.getElementById("_msAdsKeywordTableId_").getElementsByTagName('tbody')[0];
    for (var i = 0; i < msAdsKeywordTableArray.length; i++) {
        var row = wctable1.insertRow(i);
        row.classList.add('text-align-start');

        var cell1 = row.insertCell(0);
        cell1.innerHTML = msAdsKeywordTableArray[i].Keyword;

        var cell2 = row.insertCell(1);
        cell2.innerHTML = msAdsKeywordTableArray[i].AdGroupName;

        var cell3 = row.insertCell(2);
        cell3.innerHTML = msAdsKeywordTableArray[i].CampaignName;

        var cell4 = row.insertCell(3);
        cell4.innerHTML = msAdsKeywordTableArray[i].KeywordStatus;

        var cell5 = row.insertCell(4);
        cell5.innerHTML = msAdsKeywordTableArray[i].Clicks;

        var cell6 = row.insertCell(5);
        cell6.innerHTML = msAdsKeywordTableArray[i].Impressions;

        var cell7 = row.insertCell(6);
        cell7.innerHTML = msAdsKeywordTableArray[i].Ctr;

        var cell8 = row.insertCell(7);
        cell8.innerHTML = msAdsKeywordTableArray[i].AverageCpc;

        var cell9 = row.insertCell(8);
        cell9.innerHTML = msAdsKeywordTableArray[i].Spend;

        var cell10 = row.insertCell(9);
        cell10.innerHTML = msAdsKeywordTableArray[i].Conversions;

        var cell11 = row.insertCell(10);
        cell11.innerHTML = msAdsKeywordTableArray[i].ConversionRate;

        var cell12 = row.insertCell(11);
        cell12.innerHTML = msAdsKeywordTableArray[i].CostPerConversion;

    }
</script>